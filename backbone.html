<!DOCTYPE html>
<html>
<head>
	<title>Backbone</title>
	<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js" type="text/javascript"></script>
  <script src="http://cdnjs.cloudflare.com/ajax/libs/underscore.js/1.3.3/underscore-min.js" type="text/javascript"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/backbone.js/1.1.2/backbone-min.js"></script>
</head>
<body>
	<h1>Backbone!</h1>
	<div id='app'>
	</div>
  <script type="text/template" id="todolist-template">
  </script>
  <script type="text/template" id="todo-template">
  </script>
</body>

<script type="text/javascript">
	//Model Class
	var TodoItem = Backbone.Model.extend({
		defaults: {
			description: '',
			status: false
		}
	});
	//Collection Class
	var Todos = Backbone.Collection.extend({
		model: TodoItem,
		url: 'http://localhost:3000/todos'
	})
	//Collection Instance
	var todos = new Todos;
	//View Classs
	var TodoView = Backbone.View.extend({
		render: function(){
			var todoHTML = '<h3>' + this.model.get('description') + '</h3>';
      return this;
		}
	});

  todos.fetch({
    success: function(todos){
      todos.forEach(function(todo){
        var todoView = new TodoView({model: todo});
        console.log(todoView.render().el);
        $('#app').append(todoView.render().el);
      })
    }
  });

  // var TodoListView = Backbone.View.extend({
  // 	el: '#app',
  // 	tagName: 'ul',
  // 	className: 'todolist',
  // 	initialize: function() {
  //     this.template = _.template($('#todolist-template').html());
  //     this.render();
  //   },
  // 	render: function(){
  // 		that = this;
  //       this.$el.empty();
  //       this.$el.append(this.template());
  //       this.collection.each(function(model) {
  //         that.$el.append(new TodoView({model: model.toJSON()}).render().el);
  //      	});
  //     return this;
  //  	}
  // });

	//Fetch todos from Rails
	// todos.fetch({
	// 	success: function(res){
	// 		console.log("res", res);
	// 	 	res.models.forEach(function(todoItem){
	// 	  	//View Instance
	// 	  	console.log("todoItem", todoItem);
	// 			var todoView = new TodoView({ model: todoItem });
	// 			console.log("todoView", todoView);
	// 			//Render page
	// 			$('#app').append(todoView.render().el);
	// 	  });
	// 	}
	// });
 
</script>
</html>